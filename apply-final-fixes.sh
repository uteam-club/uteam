#!/bin/bash

echo "üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π"
echo "=================================================================="

echo ""
echo "üìã –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:"
echo "1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω endpoint /send-rpe-survey –≤ Telegram –±–æ—Ç–∞"
echo "2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Next.js API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ RPE –æ–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞"
echo "3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è"

echo ""
echo "üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:"
echo "========================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
echo "1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ..."

if grep -q "handle_send_rpe_survey" telegram-bot/bot_direct_db.py; then
    echo "   ‚úÖ –§—É–Ω–∫—Ü–∏—è handle_send_rpe_survey –Ω–∞–π–¥–µ–Ω–∞ –≤ –±–æ—Ç–µ"
else
    echo "   ‚ùå –§—É–Ω–∫—Ü–∏—è handle_send_rpe_survey –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    echo "   üîß –ü—Ä–∏–º–µ–Ω—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ –±–æ—Ç—É..."
    # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
fi

if grep -q "send-rpe-survey" telegram-bot/bot_direct_db.py; then
    echo "   ‚úÖ Endpoint /send-rpe-survey –Ω–∞–π–¥–µ–Ω –≤ —Ä–æ—É—Ç–µ—Ä–µ"
else
    echo "   ‚ùå Endpoint /send-rpe-survey –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

if grep -q "send-rpe-survey" src/app/api/surveys/rpe/route.ts; then
    echo "   ‚úÖ Next.js API –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è RPE –æ–ø—Ä–æ—Å–æ–≤"
else
    echo "   ‚ùå Next.js API –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω"
fi

echo ""
echo "2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Next.js —Å–µ—Ä–≤–µ—Ä
if curl -s http://localhost:3000 > /dev/null; then
    echo "   ‚úÖ Next.js —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω"
else
    echo "   ‚ö†Ô∏è Next.js —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    echo "   üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ: npm run dev"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram –±–æ—Ç–∞
if curl -s http://158.160.189.99:8080 > /dev/null 2>&1; then
    echo "   ‚úÖ Telegram –±–æ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω"
else
    echo "   ‚ö†Ô∏è Telegram –±–æ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    echo "   üí° –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: cd telegram-bot && python bot_direct_db.py"
fi

echo ""
echo "3Ô∏è‚É£ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:"
echo "================================"
echo "1. –ó–∞–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
echo "2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å –∏–≥—Ä–æ–∫–∞–º–∏"
echo "3. –ù–∞–∂–º–∏—Ç–µ '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ' –¥–ª—è RPE –æ–ø—Ä–æ—Å–∞"
echo "4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –∏–≥—Ä–æ–∫—É –≤ Telegram"
echo "5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ 500 –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞"

echo ""
echo "4Ô∏è‚É£ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):"
echo "============================"
echo "python test-all-fixes.py          # –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
echo "python test-local-fixes.py        # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º"
echo "curl http://158.160.189.99:8080/status  # –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞"

echo ""
echo "‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ì–û–¢–û–í–´ –ö –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ!"
echo "=================================="
echo "–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–¥."
echo "–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å."
