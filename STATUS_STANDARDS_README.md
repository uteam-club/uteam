# Единые стандарты статусов

## Обзор изменений

Были созданы единые стандарты статусов для устранения несогласованности в системе:

### 1. Статусы игроков в команде (PlayerStatus)
- **Формат**: `snake_case`
- **Таблица**: `Player.status`
- **Статусы**:
  - `ready` - Готов к игре
  - `rehabilitation` - Реабилитация
  - `sick` - Болеет
  - `education` - Учеба (изменено с `study`)
  - `injury` - Травма
  - `national_team` - Национальная сборная
  - `other_team` - Другая команда
  - `other` - Другое

### 2. Статусы посещаемости тренировок (AttendanceStatus)
- **Формат**: `UPPER_CASE`
- **Таблица**: `PlayerAttendance.status`
- **Статусы**:
  - `TRAINED` - Тренировался
  - `REHABILITATION` - Реабилитация (изменено с `REHAB`)
  - `SICK` - Болеет
  - `EDUCATION` - Учеба
  - `INJURY` - Травма (добавлено)
  - `NATIONAL_TEAM` - Национальная сборная (добавлено)
  - `OTHER_TEAM` - Другая команда (добавлено)
  - `OTHER` - Другое
  - `NOT_SET` - Не указан

## Измененные файлы

### Новые файлы:
- `src/lib/constants/statuses.ts` - Единые константы и типы статусов
- `scripts/migrate-status-standards.sql` - SQL миграция
- `scripts/apply-status-standards.sh` - Скрипт применения миграции

### Обновленные файлы:
- `src/components/teams/PlayerStatusModal.tsx` - Использует новые константы
- `src/components/training/AttendanceModal.tsx` - Обновлен для новых статусов
- `src/app/dashboard/analytics/attendance/page.tsx` - Использует единые константы
- `src/app/dashboard/teams/[id]/page.tsx` - Обновлен для `education` вместо `study`
- `src/locales/ru/translation.json` - Обновлены переводы

## Применение изменений

### 1. Обновление кода
```bash
git add .
git commit -m "feat: implement unified status standards"
git push
```

### 2. Применение миграции базы данных
```bash
# Автоматически
./scripts/apply-status-standards.sh

# Или вручную
psql $DATABASE_URL -f scripts/migrate-status-standards.sql
```

### 3. Проверка результатов
После применения миграции проверьте:
- Статусы игроков: `study` → `education`
- Статусы посещаемости: `REHAB` → `REHABILITATION`
- Все новые статусы доступны в модалках

## Преимущества

1. **Согласованность**: Единые названия и стили именования
2. **Расширенность**: Больше статусов для посещаемости
3. **Поддерживаемость**: Централизованные константы
4. **Типобезопасность**: Строгая типизация TypeScript
5. **Локализация**: Полная поддержка переводов

## Обратная совместимость

- API роуты остаются совместимыми
- Старые статусы автоматически обновляются миграцией
- Существующие данные сохраняются

## Тестирование

После применения изменений протестируйте:
1. Изменение статусов игроков на странице команды
2. Проставление посещаемости в модалке тренировки
3. Просмотр аналитики посещаемости
4. Все новые статусы должны отображаться корректно
