# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ GPS –æ—Ç—á–µ—Ç–æ–≤ –∏–≥—Ä–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ç—á–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è–º –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é "–ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö" –¥–∞–Ω–Ω—ã—Ö
- –ü—É—Ç–∞–Ω–∏—Ü–µ –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

## üîß –†–µ—à–µ–Ω–∏–µ

### 1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –º–æ–¥–µ–ª–µ–π**

–°–æ–∑–¥–∞–Ω —É–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å `game-model-calculator-improved.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

#### `validateMatchIds(matchIds, clubId)`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –º–∞—Ç—á–µ–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ ID –º–∞—Ç—á–µ–π
- –õ–æ–≥–∏—Ä—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ç—á–∏

#### `cleanupInvalidGameModel(playerId, clubId)`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å –∏–≥—Ä–æ–∫–∞
- –£–¥–∞–ª—è–µ—Ç –º–æ–¥–µ–ª—å, –µ—Å–ª–∏ –≤—Å–µ –º–∞—Ç—á–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å, –µ—Å–ª–∏ —á–∞—Å—Ç—å –º–∞—Ç—á–µ–π –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞

#### `calculatePlayerGameModelWithValidation(playerId, clubId, validMatchIds?)`
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ GPS –æ—Ç—á–µ—Ç—ã
- –ò—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 2. **API –¥–ª—è –æ—á–∏—Å—Ç–∫–∏**

–°–æ–∑–¥–∞–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/gps/cleanup-game-models`:
- –û—á–∏—â–∞–µ—Ç –≤—Å–µ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∫–ª—É–±–∞
- –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤
- –õ–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—á–∏—Å—Ç–∫–∏

### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**

–§—É–Ω–∫—Ü–∏—è `cleanupAllInvalidGameModels(clubId)`:
- –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –º–æ–¥–µ–ª–∏ –∫–ª—É–±–∞
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –º–∞—Ç—á –≤ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
- –£–¥–∞–ª—è–µ—Ç –∏–ª–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ API:
```bash
curl -X POST http://localhost:3000/api/gps/cleanup-game-models \
  -H "Content-Type: application/json"
```

### –û—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–¥:
```typescript
import { cleanupAllInvalidGameModels } from '@/lib/game-model-calculator-improved';

await cleanupAllInvalidGameModels('club-id');
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:
```typescript
import { calculatePlayerGameModel } from '@/lib/game-model-calculator-improved';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
const model = await calculatePlayerGameModel(playerId, clubId);
```

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏** - –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –º–∞—Ç—á–∏
2. **–û—á–∏—Å—Ç–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - —É–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ—Å—á–µ—Ç
3. **–†–∞—Å—á–µ—Ç –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏** - —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

### –ü—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π:
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –∫–ª—É–±–∞**
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ç—á–∞** –≤ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
3. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π**:
   - –í—Å–µ –º–∞—Ç—á–∏ –≤–∞–ª–∏–¥–Ω—ã ‚Üí –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
   - –ß–∞—Å—Ç—å –º–∞—Ç—á–µ–π –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ ‚Üí –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å
   - –í—Å–µ –º–∞—Ç—á–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã ‚Üí —É–¥–∞–ª–∏—Ç—å

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
```
‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ç—á–∏: match-id-1, match-id-2
üóëÔ∏è –£–¥–∞–ª—è–µ–º –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∏–≥—Ä–æ–∫–∞ player-id
üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–µ–ª—å –¥–ª—è –∏–≥—Ä–æ–∫–∞ player-id: 2/3 –º–∞—Ç—á–µ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏:
```
üìä –ù–∞–π–¥–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: 17
‚úÖ –û—á–∏—â–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: 15
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** - —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ GPS –æ—Ç—á–µ—Ç—ã
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å** - –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Ç–æ–º–∞—Ä–Ω–æ
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–ª–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
3. **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ó–∞–º–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–æ–¥—É–ª—è:
```typescript
// –°—Ç–∞—Ä—ã–π –∏–º–ø–æ—Ä—Ç
import { calculatePlayerGameModel } from '@/lib/game-model-calculator';

// –ù–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç
import { calculatePlayerGameModel } from '@/lib/game-model-calculator-improved';
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç—á–µ—Ç–æ–≤:
```typescript
// –í API —É–¥–∞–ª–µ–Ω–∏—è GPS –æ—Ç—á–µ—Ç–æ–≤
import { cleanupAllInvalidGameModels } from '@/lib/game-model-calculator-improved';

// –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞
await cleanupAllInvalidGameModels(clubId);
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–£–¥–∞–ª–µ–Ω—ã –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏** - 17 –º–æ–¥–µ–ª–µ–π —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–∞—Ç—á–∞–º–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **API –¥–ª—è –æ—á–∏—Å—Ç–∫–∏** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∏–≥—Ä–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
