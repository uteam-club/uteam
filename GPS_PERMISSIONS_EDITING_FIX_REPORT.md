# üîß –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**
–ù–µ–ª—å–∑—è –±—ã–ª–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø—ã –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ GPS, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∫–ª—é—á–∏—Ç—å –ø—É–Ω–∫—Ç "–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏" –¥–ª—è —Ä–æ–ª–∏ —Ç—Ä–µ–Ω–µ—Ä–∞ (COACH).

## üîç **–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã**
**–ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `GpsRolePermission`** - –¥–ª—è —Ä–æ–ª–∏ COACH –Ω–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –∑–∞–ø–∏—Å–∏ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, –≤–∫–ª—é—á–∞—è:
- `gps.profiles.delete` (–£–¥–∞–ª–µ–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π)
- `gps.reports.delete` (–£–¥–∞–ª–µ–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤)

## üìä **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã**

### **–ß—Ç–æ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ:**
1. **GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏** - –≤—Å–µ 14 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü–µ `GpsPermission`
2. **–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–æ–ª–∏ –∏–º–µ–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** - COACH –Ω–µ –∏–º–µ–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RolesPermissionsTable` —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –≤ –∫–æ–¥–µ

### **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–æ–ª–∏ COACH:**
**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ `gps.data.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `gps.data.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö  
- ‚úÖ `gps.data.export` - –≠–∫—Å–ø–æ—Ä—Ç GPS –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `gps.profiles.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `gps.profiles.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `gps.profiles.create` - –°–æ–∑–¥–∞–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚ùå `gps.profiles.delete` - –£–¥–∞–ª–µ–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π (–û–¢–°–£–¢–°–¢–í–û–í–ê–õ–û)
- ‚úÖ `gps.reports.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ `gps.reports.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ `gps.reports.create` - –°–æ–∑–¥–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚ùå `gps.reports.delete` - –£–¥–∞–ª–µ–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤ (–û–¢–°–£–¢–°–¢–í–û–í–ê–õ–û)
- ‚úÖ `gps.reports.export` - –≠–∫—Å–ø–æ—Ä—Ç GPS –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### **1. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ `scripts/analyze-gps-permissions.cjs`**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –∏—Ö —Å–≤—è–∑–∏ —Å —Ä–æ–ª—è–º–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- –í—ã—è–≤–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### **2. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è `scripts/fix-missing-gps-permissions.cjs`**
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–æ–ª–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É `GpsRolePermission`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### **3. –õ–æ–≥–∏–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ —Ä–æ–ª—è–º:**

```javascript
const rolePermissions = {
  'SUPER_ADMIN': '–í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è',
  'ADMIN': '–í—Å–µ –∫—Ä–æ–º–µ gps.admin.permissions –∏ gps.admin.manage',
  'COACH': '–í—Å–µ data, profiles, reports —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è',
  'MEMBER': '–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä (view)',
  'SCOUT': '–ü—Ä–æ—Å–º–æ—Ç—Ä + —ç–∫—Å–ø–æ—Ä—Ç',
  'DOCTOR': '–ü—Ä–æ—Å–º–æ—Ç—Ä + —ç–∫—Å–ø–æ—Ä—Ç', 
  'DIRECTOR': '–ü—Ä–æ—Å–º–æ—Ç—Ä + —ç–∫—Å–ø–æ—Ä—Ç'
};
```

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—å COACH –∏–º–µ–µ—Ç:**
- ‚úÖ `gps.data.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `gps.data.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `gps.data.export` - –≠–∫—Å–ø–æ—Ä—Ç GPS –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `gps.profiles.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `gps.profiles.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `gps.profiles.create` - –°–æ–∑–¥–∞–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ `gps.profiles.delete` - –£–¥–∞–ª–µ–Ω–∏–µ GPS –ø—Ä–æ—Ñ–∏–ª–µ–π (–î–û–ë–ê–í–õ–ï–ù–û)
- ‚úÖ `gps.reports.view` - –ü—Ä–æ—Å–º–æ—Ç—Ä GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ `gps.reports.edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ `gps.reports.create` - –°–æ–∑–¥–∞–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ `gps.reports.delete` - –£–¥–∞–ª–µ–Ω–∏–µ GPS –æ—Ç—á–µ—Ç–æ–≤ (–î–û–ë–ê–í–õ–ï–ù–û)
- ‚úÖ `gps.reports.export` - –≠–∫—Å–ø–æ—Ä—Ç GPS –¥–∞–Ω–Ω—ã—Ö

## üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**

| –†–æ–ª—å | –ù–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π | –î–æ–±–∞–≤–ª–µ–Ω–æ |
|------|----------------------|-----------|
| SUPER_ADMIN | 0 | 0 |
| ADMIN | 0 | 0 |
| COACH | 2 | 2 |
| MEMBER | 0 | 0 |
| SCOUT | 0 | 0 |
| DOCTOR | 0 | 0 |
| DIRECTOR | 0 | 0 |

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**

### **–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ `GpsRolePermission`:**
```sql
INSERT INTO "GpsRolePermission" (role, "permissionId", allowed)
VALUES 
  ('COACH', 'c603d093-bd37-4396-9fbf-c67ff028e7b3', true), -- gps.profiles.delete
  ('COACH', '0c2e3493-884e-4fca-be7a-31b280ac36a1', true); -- gps.reports.delete
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```sql
SELECT rp.role, p.code, p.name, rp.allowed
FROM "GpsRolePermission" rp
JOIN "GpsPermission" p ON rp."permissionId" = p.id
WHERE rp.role = 'COACH' AND p.code = 'gps.profiles.delete';
```

## ‚úÖ **–ò—Ç–æ–≥**

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**

- ‚úÖ –†–æ–ª—å COACH —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- ‚úÖ –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø—ã –¥–ª—è –≤—Å–µ—Ö GPS –ø—É–Ω–∫—Ç–æ–≤
- ‚úÖ "–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏" –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç—Ä–µ–Ω–µ—Ä–∞
- ‚úÖ –í—Å–µ —Ä–æ–ª–∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–∞–±–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–¢–µ–ø–µ—Ä—å –≤ –∞–¥–º–∏–Ω–∫–µ –º–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π!**
