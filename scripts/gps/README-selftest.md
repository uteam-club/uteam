# GPS Self-Test Script

## Описание

Self-test скрипт для проверки GPS загрузки без изменения существующей логики. Скрипт только читает, парсит, нормализует и маппит данные.

## Использование

### Базовый тест (только парсинг и обработка)
```bash
npm run gps:selftest
```

### Тест с API вызовом
```bash
npm run gps:selftest:api
```

## Переменные окружения

- `GPS_SELFTEST_SYSTEM` - GPS система (по умолчанию: B-SIGHT)
- `GPS_SELFTEST_FILE` - путь к тестовому файлу (по умолчанию: fixtures/gps/statsports_demo.csv)
- `GPS_SELFTEST_API` - включить API вызов (по умолчанию: 0)
- `GPS_SELFTEST_API_URL` - URL API (по умолчанию: http://localhost:3000/api/gps-reports)
- `GPS_SELFTEST_EVENT_ID` - ID события для API (по умолчанию: 00000000-0000-0000-0000-000000000000)
- `GPS_SELFTEST_TEAM_ID` - ID команды для API (по умолчанию: 00000000-0000-0000-0000-000000000000)

## Результаты

Все результаты сохраняются в `artifacts/selftest/`:

- `00_env.json` - переменные окружения
- `01_db.json` - снимок БД (если доступна)
- `02_profile_*.json` - профиль GPS
- `03_snapshot.json` - снапшот профиля
- `04_parsed.json` - распарсенный файл
- `05_normalized.json` - нормализованные данные
- `06_canonical.json` - канонические данные
- `07_report.md` - диагностический отчет
- `08_api_response.txt` - ответ API (если включен)
- `99_context.json` - полный контекст выполнения

## Безопасность

- Скрипт только читает данные из БД
- Не изменяет существующую логику
- Использует безопасные дефолты
- Создает временные файлы только при необходимости
