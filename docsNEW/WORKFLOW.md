# Детальный процесс разработки VISTA UTEAM

## Принципы работы с кодом и ветками

### 1. Правило "Сначала локально, потом деплой"

Главный принцип: **никогда не вносите изменения напрямую в основные ветки (dev, main)**. Это приводит к:
- Нестабильным деплоям
- Сложностям при откате изменений
- Путанице в истории коммитов
- Конфликтам при параллельной работе

### 2. Правильная последовательность разработки

```
Локальная разработка → Локальное тестирование → Отправка в feature branch → PR в dev → Тестирование на dev → PR в main
```

## Пошаговый процесс разработки новой функциональности

### Шаг 1: Создание ветки для новой функциональности

```bash
# Обновляем основные ветки
git checkout main
git pull
git checkout dev
git pull

# Создаем новую ветку из dev
git checkout -b feature/new-feature-name
```

### Шаг 2: Локальная разработка и тестирование

1. Разрабатываем функциональность в новой ветке
2. **Обязательно** запускаем локальный сервер для проверки:
   ```bash
   npm run dev
   ```
3. Проверяем работу функциональности в браузере (http://localhost:3000)
4. Запускаем линтеры и проверку типов:
   ```bash
   npm run lint
   ```
5. Проверяем сборку:
   ```bash
   npm run build
   ```

### Шаг 3: Фиксация изменений и отправка в репозиторий

```bash
# Просмотр изменений
git status
git diff

# Добавление и коммит изменений
git add .
git commit -m "тип: краткое описание изменений"

# Отправка в репозиторий
git push -u origin feature/new-feature-name
```

### Шаг 4: Создание Pull Request в dev

1. Переходим на GitHub
2. Создаем Pull Request из вашей feature-ветки в `dev`
3. Описываем внесенные изменения
4. Запрашиваем ревью (если необходимо)

### Шаг 5: Тестирование на dev-окружении

1. После мержа PR, Vercel автоматически создает деплой на preview-URL
2. Тестируем функциональность на этом URL
3. Убеждаемся, что изменения работают правильно в контексте всего приложения

### Шаг 6: Подготовка к production

1. Создаем Pull Request из `dev` в `main`
2. Проводим финальное ревью всех изменений
3. Проверяем, что все тесты проходят успешно

### Шаг 7: Деплой в production

1. После мержа в `main`, Vercel автоматически деплоит изменения в production на домен vista.uteam.club
2. Проверяем функциональность на production-окружении

## Особенности разработки в VISTA UTEAM

### Работа с данными

1. **Контекст клуба Vista**:
   - Все данные находятся в контексте единого клуба (Vista)
   - Нет необходимости фильтровать данные по clubId
   - API-запросы не требуют передачи идентификатора клуба

2. **Работа с командами**:
   - Внутри клуба поддерживается деление на команды
   - При создании компонентов, относящихся к командам, нужно учитывать связи с командами
   - Проверяйте права доступа пользователей в соответствии с их командой

### Работа с темой Vista

1. **Использование темы**:
   - Приложение использует только тему Vista
   - Нет необходимости реализовывать переключение тем
   - При разработке всегда ориентируйтесь на стилевые гайдлайны Vista

## Что делать, если что-то пошло не так

### 1. Проблемы на локальном окружении

Если возникли проблемы на локальном окружении:
1. Проверьте консоль на ошибки
2. Проверьте версии зависимостей
3. Очистите кэш:
   ```bash
   rm -rf .next
   npm run dev
   ```

### 2. Проблемы после деплоя на dev

Если функциональность работает локально, но не работает на dev-окружении:
1. Проверьте логи деплоя в Vercel Dashboard
2. Сравните переменные окружения
3. При необходимости сделайте фикс в новой ветке и повторите процесс

### 3. Отмена изменений

В случае необходимости отмены изменений в ветке:
```bash
# Отмена последнего коммита (сохраняя изменения)
git reset --soft HEAD~1

# Полная отмена последнего коммита (удаляя изменения)
git reset --hard HEAD~1
```

## Практика командной работы

### Синхронизация с основной веткой

Регулярно синхронизируйте вашу ветку с dev:
```bash
git checkout dev
git pull
git checkout feature/your-feature
git merge dev
# Разрешите конфликты, если они возникли
```

### Коммуникация в команде

1. Сообщайте о начале работы над новыми фичами
2. Обсуждайте сложные архитектурные решения до их реализации
3. Информируйте команду о успешных мержах и деплоях

## Важные запреты

1. **НИКОГДА** не коммитьте напрямую в ветки `main` или `dev`
2. **НИКОГДА** не используйте `force push` в общих ветках
3. **НИКОГДА** не мержите нестабильный код в основные ветки
4. **НИКОГДА** не игнорируйте ошибки линтера и TypeScript
5. **НИКОГДА** не добавляйте новые зависимости без согласования
6. **НИКОГДА** не деплойте код без локального тестирования 

## Конвенции именования

### Именование веток

- **Фичи**: `feature/название-фичи`
- **Исправления**: `fix/что-исправляется`
- **Рефакторинг**: `refactor/что-улучшается`
- **Документация**: `docs/что-документируется`

### Именование коммитов

Формат: `тип: краткое описание (на русском)`

Примеры:
- `фича: добавлен компонент выбора команды`
- `исправление: исправлена ошибка авторизации`
- `рефакторинг: оптимизирован запрос получения пользователей`
- `документация: обновлена инструкция по развертыванию`

## Чеклист перед созданием Pull Request

- [ ] Код работает локально без ошибок
- [ ] Код проходит проверку линтером и TypeScript
- [ ] Пройдена сборка проекта
- [ ] Код соответствует стилевым гайдлайнам
- [ ] Добавлены тесты (если необходимо)
- [ ] Обновлена документация (если необходимо)
- [ ] Нет лишних console.log и закомментированного кода 